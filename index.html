<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Hello World!</title>
  <link rel="stylesheet" href="./static/bootstrap-3.3.7-dist/css/bootstrap.min.css">
  <script src="./static/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
</head>

<body>
  <style>
    .container {
      margin-top: 20px;
      margin-bottom: 20px;
    }
  </style>
  <div class="container">
    <div class="container-fluid">

      <!-- Ranking -->
      <div class="panel panel-warning" style="display:none">
        <div class="panel-heading">
          <h3 class="panel-title">Ranking List</h3>
        </div>
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Position</th>
              <th>Team</th>
              <th>Played</th>
              <th>Won</th>
              <th>Drawn</th>
              <th>Lost</th>
              <th>Goal</th>
              <th>Against</th>
              <th>Goal Difference</th>
              <th>Points</th>
            </tr>
          </thead>
          <tbody id="ranking"></tbody>
        </table>
      </div>

      <!-- Players -->
      <div class="panel panel-warning">
        <div class="panel-heading">
          <h3 class="panel-title">Top Scorers</h3>
        </div>
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Rank</th>
              <th>Player</th>
              <th>Club</th>
              <th>Goals</th>
            </tr>
          </thead>
          <tbody id="players"></tbody>
        </table>
      </div>

    </div>
  </div>
  <script>
    window.$ = require("./static/jquery-3.2.1.min.js")

    let barca = {
      ranking: function () {
        $.get("http://www.espnfc.com/spanish-primera-division/15/table", function (response) {
          let html = $(response)
          let teamList = []

          html.find("#tables-overall table tbody tr").each(function () {
            let row = $(this).children()
            let team = []

            row.each(function () {
              team.push($(this).text())
            })

            if (team[0] !== "POS") {
              teamList.push([team[0], team[1].replace(/(^\s*)|(\s*$)/g, ""), team[3], team[4], team[5], team[6], team[7], team[8], team[22], team[23]])
            }
          })

          let body = ""

          for (let row of teamList) {
            let tr = "<tr>"

            if (row[1] === "Barcelona") {
              tr = "<tr class='success'>"
            }

            for (let td of row) {
              tr += "<td>" + td + "</td>"
            }

            tr += "</td>"

            body += tr
          }

          $("#ranking").html(body)
        })
      },
      players : function(){
        $.get("http://www.espnfc.com/spanish-primera-division/15/statistics/scorers", function(response){
          let html = $(response)
          let playerList = []

          html.find("#stats-top-scorers table tbody tr").each(function(){
            let row = $(this).children()
            let player = []

            row.each(function(){
              player.push($(this).text())
            })

            playerList.push(player)
          })

          let body = ""

          for (let row of playerList){
            let tr = "<tr>"

            if (row[2] === "Barcelona") {
              tr = "<tr class='success'>"
            }

            for (let td of row) {
              tr += "<td>" + td + "</td>"
            }

            tr += "</td>"

            body += tr
          }

          $("#players").html(body)
        })
      }
    }

    barca.players()
  </script>
</body>

</html>